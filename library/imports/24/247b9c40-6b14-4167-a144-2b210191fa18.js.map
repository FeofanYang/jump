{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\block.js"],"names":["cc","Class","extends","Component","start","mid","node","getChildByName","top","btm","left","right","isMid","test_pos","w_pos","direction","mid_pos","convertToWorldSpaceAR","p","dir","pSub","min_len","pLength","min_pos","top_pos","cur_len","btm_pos","left_pos","right_pos","x","y","playScoreFn","play_blockLight","getComponent","Animation","play_blockDorp"],"mappings":"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","file":"block.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    start () {\r\n        this.mid = this.node.getChildByName('mid');\r\n        this.top = this.node.getChildByName('top');\r\n        this.btm = this.node.getChildByName('btm');\r\n        this.left = this.node.getChildByName('left');\r\n        this.right = this.node.getChildByName('right');\r\n        this.isMid = null;\r\n    },\r\n\r\n    // 世界位置 与 方向dir = -1(left) || dir = 1(right)\r\n    test_pos(w_pos, direction) {\r\n        var mid_pos = this.mid.convertToWorldSpaceAR(cc.p(0, 0));\r\n        // 求目标位置到点的位置\r\n        var dir = cc.pSub(w_pos, mid_pos);\r\n        // 争夺最近距离；争夺最小点\r\n        var min_len = cc.pLength(dir);\r\n        var min_pos = mid_pos;\r\n\r\n        if(direction == 1) {\r\n            var top_pos = this.top.convertToWorldSpaceAR(cc.p(0, 0));\r\n            // 求目标位置到点的位置\r\n            dir = cc.pSub(w_pos, top_pos);\r\n            var cur_len = cc.pLength(dir);\r\n            // 争夺过程，下同\r\n            if(min_len > cur_len){\r\n                min_len = cur_len;\r\n                min_pos = top_pos;\r\n            }\r\n            var btm_pos = this.btm.convertToWorldSpaceAR(cc.p(0, 0));\r\n            dir = cc.pSub(w_pos, btm_pos);\r\n            var cur_len = cc.pLength(dir);\r\n            if(min_len > cur_len){\r\n                min_len = cur_len;\r\n                min_pos = btm_pos;\r\n            }\r\n        }\r\n        else {\r\n            var left_pos = this.left.convertToWorldSpaceAR(cc.p(0, 0));\r\n            dir = cc.pSub(w_pos, left_pos);\r\n            var cur_len = cc.pLength(dir);\r\n            if(min_len > cur_len){\r\n                min_len = cur_len;\r\n                min_pos = left_pos;\r\n            }\r\n            var right_pos = this.right.convertToWorldSpaceAR(cc.p(0, 0));\r\n            dir = cc.pSub(w_pos, right_pos);\r\n            var cur_len = cc.pLength(dir);\r\n            if(min_len > cur_len){\r\n                min_len = cur_len;\r\n                min_pos = right_pos;\r\n            }\r\n        }\r\n        if(min_pos == mid_pos){\r\n            this.isMid = true;\r\n        }else{\r\n            this.isMid = false;\r\n        }\r\n        // 目标位置与参考点距离 小于100则为true\r\n        dir = cc.pSub(w_pos, min_pos);\r\n        if( cc.pLength(dir)<= 100){\r\n            w_pos.x = min_pos.x;\r\n            w_pos.y = min_pos.y;\r\n            return true;\r\n        }else{\r\n            return false;\r\n        }\r\n    },\r\n\r\n    playScoreFn: function() {\r\n        return this.isMid;\r\n    },\r\n\r\n    play_blockLight: function() {\r\n        return this.node.getChildByName('mid_light').getComponent(cc.Animation);\r\n    },\r\n\r\n    play_blockDorp: function() {\r\n        return this.node.getChildByName('block').getComponent(cc.Animation);\r\n    },\r\n});\r\n"]}